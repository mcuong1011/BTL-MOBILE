Bug fixes & some minor improvements.